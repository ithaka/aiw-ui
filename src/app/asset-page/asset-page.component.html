<div *ngIf="assets[0]" class="container-fluid asset-page" [class.fullscreen]="isFullscreen">
    <div class="row">
        <!--View prev/next asset-->
        <div class="title-nav-cntnr col-md-12" [class.hidden]="isFullscreen">
            <span *ngIf="prevRouteParams.length > 0" class="back-results" (click)="backToResults()">Back to Results</span>
            <i title="Previous in results" (click)="showPrevAsset()" [class.disabled]="assetNumber <= 1" class="icon icon-direction icon-left"></i>
            <div class="title" [innerHTML]="assets[0].title ? assets[0].title : ''"></div>
            <i title="Next in results" (click)="showNextAsset()" [class.disabled]="assetNumber >= totalAssetCount" class="icon icon-direction icon-right"></i>
            <div class="page-tooltip">
                <span id="assetPageNumber">{{ assetNumber }}</span> OF <span id="assetPageCount">{{ totalAssetCount }}</span>
            </div>
        </div>
        <!--Asset Viewer Row-->
        <div class="asset-col" [ngClass]="[ isFullscreen ? 'fullscreen-container' : 'col-md-8' ]">
            <!--<div class="row asset-row">-->
                <ang-asset-viewer *ngFor="let asset of (isFullscreen ? assets : [assets[0]]); let i = index"
                    [asset]="asset" 
                    [ngClass]="[ 'asset-viewer-' + assets.length ]"
                    (fullscreenChange)="updateFullscreenVar($event)" 
                    [index]="i" 
                    [assetCompareCount]="assets.length"
                    [assetNumber]="assetNumber"
                    [assetGroupCount]="totalAssetCount"
                    [assets]="assets"
                    [isFullscreen]="isFullscreen"
                    [prevAssetResults]="prevAssetResults"
                    (removeAsset)="toggleAsset(asset)"
                    (nextPage)="showNextAsset()"
                    (prevPage)="showPrevAsset()"></ang-asset-viewer>
            <!--</div>-->
        </div>
        <!--Asset Metadata Row-->
        <div [class.hidden]="isFullscreen" class="col-md-4">
            <div class="py-3">
                 <!--If the user has not accepted the agreement, show modal when clicked, otherwise download immediately-->
                
                <button class="btn btn-secondary"  tabindex="1" (click)="copyGeneratedImgURL()">
                    Link
                    <i id="genImgURLlink" class="icon icon-share-white" ></i>
                </button>
                <a class="btn btn-secondary" tabindex="1" *ngIf="assets[0].downloadLink && user.isLoggedIn" 
                    [attr.href]="downloadAuth() && !assets[0].disableDownload ? assets[0].downloadLink : null"
                    (click)="downloadAuth() && !assets[0].disableDownload ? null : showAgreeModal = true"
                    [attr.download]="downloadAuth() && assets[0].title"
                    [class.disabled]="assets[0].disableDownload"
                    title="{{ assets[0].disableDownload ? 'Image is not available for download.' : 'Image download'}}">
                    Download
                    <i id="downloadAssetLink" class="icon icon-download" ></i>
                </a>
                <button class="btn btn-secondary" tabindex="1" *ngIf="assets[0].downloadLink && !user.isLoggedIn" (click)="showLoginModal = true">
                    Download
                    <i id="downloadAssetLink" class="icon icon-download" ></i>
                </button>
                <button (click)="showAddModal = true" class="btn btn-primary">
                    <i class="icon icon-add-white" aria-hidden="true"></i>
                </button>
                <div *ngIf="copyURLStatusMsg" class="alert alert-info">{{ copyURLStatusMsg }}</div>

                <div class="row-hdr pt-3" *ngIf="assets[0].metaDataArray.length > 0">Object Details</div>
                <!--Loop through metaData Array-->
                <div class="meta-block" *ngFor="let metadataObj of assets[0].metaDataArray">
                    <div [attr.id]="cleanId(metadataObj.fieldName)" class="label">{{ metadataObj.fieldName }}
                    <div class="value" [innerHTML]="metadataObj.fieldValue"></div>
                    </div>
                </div>

                <div class="row-hdr pt-1" *ngIf="assets[0].filePropertiesArray.length > 0">File Properties</div>
                <!--Loop through File Properties Array-->
                <div class="meta-block" *ngFor="let filePropObj of assets[0].filePropertiesArray">
                    <div [attr.id]="cleanId(filePropObj.fieldName)" class="label">{{ filePropObj.fieldName }}
                        <div class="value" [innerHTML]="filePropObj.fieldValue"></div>
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="isFullscreen" class="fullscreen-btns">
            <button class="btn btn-dark" (click)="exitPresentationMode()">
                Exit
            </button>
            <button class="btn btn-dark" (click)="showAssetDrawer = !showAssetDrawer">
                Compare
            </button>
        </div>

    <!-- Asset Drawer -->
    <div class="asset-drawer" [class.slideOut]="showAssetDrawer && isFullscreen">
        <div class="col-sm-12">
            <div *ngIf="prevAssetResults.thumbnails.length < 1">
                <div class="alert alert-info">To compare assets, you will need to access an asset through a set of results first. Then those results will show here.</div>
            </div>
            <div *ngFor="let asset of prevAssetResults.thumbnails" class="card card--asset" [ngClass]="{'selected' : asset.selected, 'disabled' : assets[0].id == asset.objectId }" (click)="toggleAsset(asset)">
                <div class="card-block card-text">
                    <div class="card-img-top">
                        <img [attr.src]="_assets.makeThumbUrl(asset.thumbnailImgUrl, 0)" alt="Card image cap">
                    </div>
                    <!--<div>
                        <i *ngIf="asset.cfObjectId.length > 0" [id]="asset.objectId + '_associated_images'" class="icon icon-collab" [routerLink]="['/associated', asset.cfObjectId, asset.collectionId]"></i>
                        <i *ngIf="asset.clustered == 1" [id]="asset.objectId + '_clustered_images'" class="icon icon-cluster" [routerLink]="['/cluster', asset.objectId, { objTitle :  asset.thumbnail1 }]"></i>
                        <i *ngIf="asset.iapFlag > 0" class="icon icon-iap"></i>
                        <i *ngIf="asset.objectTypeId && asset.objectTypeId != 10" class="icon icon-{{asset.objectTypeId | typeIdPipe}}"></i>
                        <i class="icon icon-{{collectionTypeMap[asset.collectionType]}} icon-collection-type"></i>
                    </div>-->
                    <div class="card-text-group">
                        <span class="asset-title" title="{{ asset.thumbnail1 }}">{{ asset.thumbnail1 }}</span>
                        <span class="asset-agent" title="{{ asset.thumbnail2 }}">{{ asset.thumbnail2 }}</span>
                        <span class="asset-date" title="{{ asset.thumbnail3 }}">{{ asset.thumbnail3 }}</span>
                        <span title="{{ asset.thumbnail4 }}">{{ asset.thumbnail4 }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<ang-agree-modal *ngIf="showAgreeModal" (closeModal)="showAgreeModal = false" [asset]="assets[0]"></ang-agree-modal>
<ang-login-req-modal *ngIf="showLoginModal" (closeModal)="showLoginModal = false"></ang-login-req-modal>
<ang-add-to-group *ngIf="showAddModal" [selectedAssets]="[ assets[0] ]" [showCreateGroup]="true" (createGroup)="showCreateGroupModal = true; showAddModal = false;" (closeModal)="showAddModal = false"></ang-add-to-group>
<ang-new-ig-modal *ngIf="showCreateGroupModal" [selectedAssets]="[ assets[0] ]" [showAddToGroup]="true" (addToGroup)="showAddModal = true; showCreateGroupModal = false;" (closeModal)="showCreateGroupModal = false"></ang-new-ig-modal>